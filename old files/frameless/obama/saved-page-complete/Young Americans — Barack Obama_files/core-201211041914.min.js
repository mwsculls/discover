function getURLParam(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t),r=n.exec(window.location.href);return r==null?"":decodeURIComponent(decodeURIComponent(r[1])).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}try{(function(e,t,n){var r=e("script[data-identity]"),i=r.data("identity"),s=r.data("www"),o=r.data("bsd"),u=t.ofa||{},a=e.isEmptyObject(u),f=t._gaq||[],l=t.USER_DATA,c,h,p=/(login-signedin|login-information)/,d=/elc/,v=/bsd-session-lc/;e.cookie||(jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined)n.expires=-1;if(typeof n.expires=="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return e}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null});if(a||!u.cookieDomain)u.cookieDomain=s.split("www")[1];if(a||!u.debug||!u.debug.log){u.debug=u.debug||{};u.debug.enabled=typeof t.ofa_debug=="boolean"||e(".ofa-debug").length>0?!0:!1;u.debug.ie_enabled=e(".ofa-ie-debug").length>0?!0:!1;u.debug.log=function(){var e=typeof console=="undefined"?!0:!1,t=function(e){console.log(e)},n=u.debug.ie_enabled?function(e){alert(e)}:function(){},r=e?n:t;return u.debug.enabled?r:function(){}}()}if(a||!u.getURLParam)u.getURLParam=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t),r=n.exec(window.location.href);return r===null?"":decodeURIComponent(decodeURIComponent(r[1])).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};c={old:l,type:"",is_donate_page:e("body.donate").length?!0:!1,is_logged_in:!1,account_info:{},checked_account_status:!1,guid:"",username:"",email:"",first_name:"",last_name:"",address:{is_complete_address:!1,street:"",street_2:"",city:"",state:"",zip:"",country:""},phone:"",employer:"",occupation:"",quick_donate:{enabled:!1,token:"",cc_last_four:"",cc_type:"",cc_expir_month:"",cc_expir_year:""},account:{first_name:"",last_name:""},callback:{queue:e.Callbacks("unique memory"),run_queue:function(){u.debug.log("USER_DATA.callback.run_queue();");c.callback.queue.fire(this)},push:function(e){u.debug.log("USER_DATA.callback.push();");c.callback.queue.add(e)}},account_links:undefined,idResponse:undefined,qdResponse:undefined,spudResponse:undefined,hcResponse:undefined,sendResponseTimeToGA:function(e,t){u.debug.log("sendResponseTimeToGA();");var n=new Date,r=n.getTime()-e.getTime(),i="?";r<100?i="< 100ms":r<200?i="< 200ms":r<300?i="< 300ms":r<400?i="< 400ms":r<500?i="< 500ms":r<600?i="< 600ms":r<700?i="< 700ms":r<800?i="< 800ms":i="800ms+";u.debug.log("responseDifference: "+r);u.debug.log("responseDifferenceRounded: "+i);f.push(["_trackEvent","Ajax response time",t,i,r,!0])},fetch_personal_info:function(){u.debug.log("USER_DATA.fetch_personal_info();");var t=e.cookie("login-information"),n=e.cookie("donorhash")||u.getURLParam("keycode"),s=e.cookie("spud")||!0,a=o+"/modules/spud/get.php?mode=standard&fields%5B%5D=firstname&fields%5B%5D=lastname&fields%5B%5D=addr1&fields%5B%5D=addr2&fields%5B%5D=city&fields%5B%5D=state_cd&fields%5B%5D=zip&fields%5B%5D=country&fields%5B%5D=phone&fields%5B%5D=email&fields%5B%5D=employer&fields%5B%5D=occupation",l=r.data("token"),h=l?!0:!1,p=e("[data-disable-token]").length===0?!0:!1,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F=i+"/account/info/",I,q=e.cookie("login-information"),R=e.cookie("login-signedin")||q?!0:!1,U,z;w=function(e){if(typeof e.enabled=="boolean"&&typeof e.token=="string"&&typeof e.token_info=="object"){u.debug.log("qd response passed first sanity check");return!0}x(e);return!1};x=function(e){u.debug.log("quick donate is not enabled for this user");var t=[],n,r;typeof e.enabled!="boolean"&&t.push("Typeof data.enabled not boolean: "+typeof e.enabled);typeof e.token!="string"&&t.push("Typeof data.token not string: "+typeof e.token);typeof e.token_info!="object"&&t.push("Typeof data.token_info not object: "+typeof e.token_info);n=t.length;for(r=0;r<n;r++){f.push(["_trackEvent","API response malformed","Quick Donate",t[r]]);u.debug.log(t[r])}};E=function(e){if(e.enabled===!0&&e.token&&typeof e.token_info.account_last_four=="string"&&typeof e.token_info.cc_type_cd=="string"&&typeof e.token_info.cc_expir_month=="string"&&typeof e.token_info.cc_expir_year=="string"&&typeof e.token_info.firstname=="string"&&typeof e.token_info.lastname=="string"&&typeof e.token_info.addr1=="string"&&typeof e.token_info.addr2=="string"&&typeof e.token_info.city=="string"&&typeof e.token_info.state_cd=="string"&&typeof e.token_info.zip=="string"&&typeof e.token_info.country=="string"&&typeof e.token_info.email=="string"&&typeof e.token_info.phone=="string"&&typeof e.token_info.employer=="string"&&typeof e.token_info.occupation=="string"){u.debug.log("qd response passed second sanity check");return!0}T(e);return!1};T=function(e){var t=[],n,r;e.enabled!==!0&&t.push("data.enabled value not true: "+e.enabled);e.token||t.push("data.token has no value");typeof e.token_info.account_last_four!="string"&&t.push("data.token_info.account_last_four not string: "+typeof e.token_info.account_last_four);typeof e.token_info.cc_type_cd!="string"&&t.push("data.token_info.cc_type_cd not string: "+typeof e.token_info.cc_type_cd);typeof e.token_info.cc_expir_month!="string"&&t.push("data.token_info.cc_expir_month not string: "+typeof e.token_info.cc_expir_month);typeof e.token_info.cc_expir_year!="string"&&t.push("data.token_info.cc_expir_year not string: "+typeof e.token_info.cc_expir_year);typeof e.token_info.firstname!="string"&&t.push("data.token_info.firstname not string: "+typeof e.token_info.firstname);typeof e.token_info.lastname!="string"&&t.push("data.token_info.lastname not string: "+typeof e.token_info.lastname);typeof e.token_info.addr1!="string"&&t.push("data.token_info.addr1 not string: "+typeof e.token_info.addr1);typeof e.token_info.addr2!="string"&&t.push("data.token_info.addr2 not string: "+typeof e.token_info.addr2);typeof e.token_info.city!="string"&&t.push("data.token_info.city not string: "+typeof e.token_info.city);typeof e.token_info.state_cd!="string"&&t.push("data.token_info.state_cd not string: "+typeof e.token_info.state_cd);typeof e.token_info.zip!="string"&&t.push("data.token_info.zip not string: "+typeof e.token_info.zip);typeof e.token_info.country!="string"&&t.push("data.token_info.country not string: "+typeof e.token_info.country);typeof e.token_info.email!="string"&&t.push("data.token_info.email not string: "+typeof e.token_info.email);typeof e.token_info.phone!="string"&&t.push("data.token_info.phone not string: "+typeof e.token_info.phone);typeof e.token_info.employer!="string"&&t.push("data.token_info.employer not string: "+typeof e.token_info.employer);typeof e.token_info.occupation!="string"&&t.push("data.token_info.occupation not string: "+typeof e.token_info.occupation);n=t.length;for(r=0;r<n;r++){f.push(["_trackEvent","API response malformed","Quick Donate",t[r]]);u.debug.log(t[r])}};S=function(e){if(e.token_info.account_last_four.length===4&&(e.token_info.cc_expir_month.length===2||e.token_info.cc_expir_month.length===1)&&e.token_info.cc_expir_year.length===4&&e.token_info.firstname&&e.token_info.lastname&&e.token_info.addr1&&e.token_info.city&&e.token_info.state_cd.length===2&&e.token_info.zip.length===5&&e.token_info.country&&e.token_info.email&&e.token_info.phone&&e.token_info.employer&&e.token_info.occupation&&(e.token_info.cc_type_cd==="vs"||e.token_info.cc_type_cd==="mc"||e.token_info.cc_type_cd==="ax"||e.token_info.cc_type_cd==="ds")){u.debug.log("qd response passed third sanity check. now filling in object with response data.");return!0}N(e);return!1};N=function(e){var t=function(e){f.push(["_trackEvent","Ajax error","/ctl/Contribution/Quick/GetToken?jsonp=callback=?","Second sanity check",e])},n="Third sanity check: ";if(e.token_info.account_last_four.length!==4){n+="data.token_info.account_last_four.length not 4: "+e.token_info.account_last_four.length;t(n);u.debug.log(n)}if(e.token_info.cc_expir_month.length!==2&&e.token_info.cc_expir_month.length!==1){n+="data.token_info.cc_expir_month.length not 1 or 2: "+e.token_info.cc_expir_month.length+". ";t(n);u.debug.log(n)}if(e.token_info.cc_expir_year.length!==4){n+="data.token_info.cc_expir_year.length not 4: "+e.token_info.cc_expir_year.length+". ";t(n);u.debug.log(n)}if(!e.token_info.firstname){n+="data.token_info.firstname is blank string.";t(n);u.debug.log(n)}if(!e.token_info.lastname){n+="data.token_info.lastname is blank string.";t(n);u.debug.log(n)}if(!e.token_info.addr1){n+="data.token_info.addr1 is blank string.";t(n);u.debug.log(n)}if(!e.token_info.city){n+="data.token_info.city is blank string.";t(n);u.debug.log(n)}if(!e.token_info.state_cd){n+="data.token_info.state_cd is blank string.";t(n);u.debug.log(n)}if(e.token_info.state_cd.length!==2){n+="data.token_info.state_cd.length not 2:"+e.token_info.state_cd.length;t(n);u.debug.log(n)}if(e.token_info.state_cd.zip!==5){n+="data.token_info.zip.length not 2:"+e.token_info.zip.length;t(n);u.debug.log(n)}if(!e.token_info.country){n+="data.token_info.country is blank string.";t(n);u.debug.log(n)}if(!e.token_info.email){n+="data.token_info.email is blank string.";t(n);u.debug.log(n)}if(!e.token_info.phone){n+="data.token_info.phone is blank string.";t(n);u.debug.log(n)}if(!e.token_info.employer){n+="data.token_info.employer is blank string.";t(n);u.debug.log(n)}if(!e.token_info.occupation){n+="data.token_info.occupation is blank string.";t(n);u.debug.log(n)}if(e.token_info.cc_type_cd!=="vs"&&e.token_info.cc_type_cd!=="mc"&&e.token_info.cc_type_cd!=="ax"&&e.token_info.cc_type_cd!=="ds"){n+="data.token_info.cc_type_cd !== vs || mc || ax || ds";t(n);u.debug.log(n)}};y=function(e){var t=[],n,r;typeof e.occupation!="string"&&t.push("data.occupation not string: "+typeof e.occupation);typeof e.city!="string"&&t.push("data.city not string: "+typeof e.city);typeof e.zip!="string"&&t.push("data.zip not string: "+typeof e.zip);typeof e.address_1!="string"&&t.push("data.address_1 not string: "+typeof e.address_1);typeof e.address_2!="string"&&t.push("data.address_2 not string: "+typeof e.address_2);typeof e.phone!="string"&&t.push("data.phone not string: "+typeof e.phone);typeof e.last_name!="string"&&t.push("data.last_name not string: "+typeof e.last_name);typeof e.employer!="string"&&t.push("data.employer not string: "+typeof e.employer);typeof e.state!="string"&&t.push("data.state not string: "+typeof e.state);typeof e.first_name!="string"&&t.push("data.first_name not string: "+typeof e.first_name);typeof e.email!="string"&&t.push("data.email not string: "+typeof e.email);n=t.length;for(r=0;r<n;r++){f.push(["_trackEvent","API response malformed","HashCloud",t[r]]);u.debug.log(t[r])}};b=function(e){var t=[],n,r;e.occupation||t.push("data.occupation is blank string");e.city||t.push("data.city is blank string");e.zip||t.push("data.zip is blank string");e.address_1||t.push("data.address_1 is blank string");e.phone||t.push("data.phone is blank string");e.last_name||t.push("data.last_name is blank string");e.employer||t.push("data.employer is blank string");e.state||t.push("data.state is blank string");e.first_name||t.push("data.first_name is blank string");e.email||t.push("data.email is blank string");n=t.length;for(r=0;r<n;r++){f.push(["_trackEvent","API response malformed","HashCloud",t[r]]);u.debug.log(t[r])}};g=function(e){if(typeof e.occupation=="string"&&typeof e.city=="string"&&typeof e.zip=="string"&&typeof e.address_1=="string"&&typeof e.address_2=="string"&&typeof e.phone=="string"&&typeof e.last_name=="string"&&typeof e.employer=="string"&&typeof e.state=="string"&&typeof e.first_name=="string"&&typeof e.email=="string"){u.debug.log("hashcloud response passed first sanity check");if(e.occupation&&e.city&&e.zip&&e.address_1&&e.phone&&e.last_name&&e.employer&&e.state&&e.first_name&&e.email){u.debug.log("hashcloud response passed second sanity check. filling object with response data.");return!0}u.debug.log("hashcloud response failed the second sanity check, sending errors to Google Analytics");b(e)}else{u.debug.log("hashcloud response failed the first sanity check, sending errors to Google Analytics");y(e)}return!1};H=function(t){return!e.isArray(t)};O=function(e){var t=e[0];u.debug.log("received response for users saved payment info from bsd");if(w(t))if(E(t))if(S(t)){c.qdResponse=t;c.type="quick donate";c.address.is_complete_address=!0;c.first_name=t.token_info.firstname;c.last_name=t.token_info.lastname;c.phone=t.token_info.phone;c.employer=t.token_info.employer;c.occupation=t.token_info.occupation;c.email=t.token_info.email;c.address.street=t.token_info.addr1;c.address.street_2=t.token_info.addr2;c.address.city=t.token_info.city;c.address.state=t.token_info.state_cd;c.address.zip=t.token_info.zip;c.quick_donate.enabled=!0;c.quick_donate.token=t.token;c.quick_donate.cc_last_four=t.token_info.account_last_four;c.quick_donate.cc_type=t.token_info.cc_type_cd;t.token_info.cc_expir_month.length===1?c.quick_donate.cc_expir_month="0"+t.token_info.cc_expir_month:c.quick_donate.cc_expir_month=t.token_info.cc_expir_month;c.quick_donate.cc_expir_year=t.token_info.cc_expir_year}else u.debug.log("the quick donate response failed third sanity check");else u.debug.log("the quick donate response failed the second sanity check");else u.debug.log("the quick donate response failed the first sanity check.")};M=function(e){var t=e[0];u.debug.log("received response from hashcloud");if(g(t)){u.debug.log("hashcloud response passed both sanity checks. filling object with response data.");c.hcResponse=t;c.type="keycode";c.address.is_complete_address=!0;c.first_name=t.first_name;c.last_name=t.last_name;c.phone=t.phone;c.employer=t.employer;c.occupation=t.occupation;c.email=t.email;c.address.street=t.address_1;t.address_2!=="NULL"&&(c.address.street_2=t.address_2);c.address.city=t.city;c.address.state=t.state;c.address.zip=t.zip}else u.debug.log("hashcloud response failed one of the sanity checks");u.debug.log("done with processing the hashcloud response")};_=function(e){u.debug.log("fetch_personal_info -> processing the spud info");c.spudResponse=e;c.type="spud";c.first_name=e.firstname?e.firstname:"";c.last_name=e.lastname?e.lastname:"";c.phone=e.phone?e.phone:"";c.employer=e.employer?e.employer:"";c.occupation=e.occupation?e.occupation:"";c.email=e.email?e.email:"";c.address.street=e.addr1?e.addr1:"";c.address.street_2=e.addr2?e.addr2:"";c.address.city=e.city?e.city:"";c.address.state=e.state_cd?e.state_cd:"";c.address.country=e.country?e.country:"";c.address.zip=e.zip?e.zip:"";e.addr1&&e.city&&e.state_cd&&e.zip&&(c.address.is_complete_address=!0);u.debug.log("fetch_personal_info -> done processing the spud info")};z=function(e){var t;c.idResponse=e;if(typeof e.firstname=="string"&&typeof e.lastname=="string"){c.account.first_name=e.firstname;c.account.last_name=e.lastname}if(c.type!=="keycode"&&c.type!=="quick donate"){u.debug.log("fetch_account_info -> user object doesn't contain any data from QD or HC, so attempting to fill it with identity account info");if(typeof e.email=="object"&&typeof e.address=="object"){u.debug.log("fetch_account_info -> identity account data passed first sanity check. fill user object with account response data.");c.type="account";typeof e.employer=="string"&&(c.employer=e.employer);typeof e.occupation=="string"&&(c.occupation=e.occupation);for(t=0;t<=e.email.length-1;t++)if(e.email[t].is_primary===!0){c.email=e.email[t].email;break}if(typeof e.firstname=="string"){c.first_name=e.firstname;e.firstname?c.account.first_name=e.firstname:c.account.first_name=c.email}if(typeof e.lastname=="string"){c.last_name=e.lastname;c.account.last_name=e.lastname}for(t=0;t<=e.address.length-1;t++)if(typeof e.address[t].is_primary=="boolean"&&e.address[t].is_primary===!0){typeof e.address[t].addr1=="string"&&(c.address.street=e.address[t].addr1);typeof e.address[t].addr2=="string"&&(c.address.street_2=e.address[t].addr2);typeof e.address[t].city=="string"&&(c.address.city=e.address[t].city);typeof e.address[t].state_cd=="string"&&(c.address.state=e.address[t].state_cd);typeof e.address[t].postal_code=="string"&&(c.address.zip=e.address[t].postal_code);typeof e.address[t].country=="string"&&(c.address.country=e.address[t].country);break}if(typeof e.phone=="object")for(t=0;t<=e.phone.length-1;t++)if(e.phone[t].is_primary===!0){c.phone=e.phone[t].phone;break}}else{u.debug.log("bsd account failed first response sanity check");var n=[];typeof e.email!="object"&&n.push("data.email not string: "+typeof e.email);typeof e.address!="object"&&n.push("data.address not string: "+typeof e.address);for(t=0;t<=n.length-1;t++){f.push(["_trackEvent","API response malformed","BSD account",n[t]]);u.debug.log(n[t])}}}c.account_links=e.account_links?e.account_links:undefined};C=function(){u.debug.log("fetch_personal_info -> getAccountInfoFromURL");c.first_name=decodeURIComponent(decodeURIComponent(u.getURLParam("firstname")));c.last_name=decodeURIComponent(decodeURIComponent(u.getURLParam("lastname")));c.address.street=decodeURIComponent(decodeURIComponent(u.getURLParam("addr1")));c.address.street_2=decodeURIComponent(decodeURIComponent(u.getURLParam("addr2")));c.address.city=decodeURIComponent(decodeURIComponent(u.getURLParam("city")));c.address.state=decodeURIComponent(decodeURIComponent(u.getURLParam("state_cd")));c.address.zip=decodeURIComponent(decodeURIComponent(u.getURLParam("zip")));c.email=decodeURIComponent(decodeURIComponent(u.getURLParam("email")));c.phone=decodeURIComponent(decodeURIComponent(u.getURLParam("phone")));c.employer=decodeURIComponent(decodeURIComponent(u.getURLParam("employer")));c.occupation=decodeURIComponent(decodeURIComponent(u.getURLParam("occupation")));c.address.is_complete_address=c.address.street&&c.address.city&&c.address.state&&c.address.zip?!0:!1;c.type=c.first_name||c.last_name||c.address.street||c.address.street_2||c.address.city||c.address.state||c.address.zip||c.email||c.phone||c.employer||c.occupation?"url":""};B=function(e,t,n,r){u.debug.log("fetch_personal_info -> quick donate, identity, hashcloud, and spud responses have returned");P=e[0]?e[0].enabled:!1;u.debug.log("fetch_personal_info -> validQDResponse: "+P);if(P){u.debug.log("fetch_personal_info -> using user quickdonate info");O(e)}else if(typeof n.sent=="undefined"){u.debug.log("fetch_personal_info -> user does not have quick donate but has info in hashcloud");M(n)}else if(H(r[0])){u.debug.log("fetch_personal_info -> user does not have quick donate or hashcloud info, but has a valid spud response");_(r[0])}else{u.debug.log("fetch_personal_info -> no quick donate, no hashcloud, and no spud, so checking for info in url");C()}if(U){u.debug.log("fetch_personal_info -> Identity Graph API call returned, using that");u.debug.log(t);if(t){u.debug.log("fetch_personal_info -> calling saveGraphData function on identityResponse");c.is_logged_in=!0;z(t[0])}else{u.debug.log("fetch_personal_info -> the user is not logged in");c.is_logged_in=!1}}c.callback.queue.fire(c)};j=function(e,t,n,r){c.callback.queue.fire(c)};u.debug.log("fetch_personal_info -> checking which requests for information to make");if(h&&t&&p){u.debug.log("fetch_personal_info -> making a getToken request");d=new Date;k=e.ajax({url:l,dataType:"json",timeout:1e4});k.done(function(e){c.sendResponseTimeToGA(d,"Quick Donate token")})}else{u.debug.log("fetch_personal_info -> no getToken request");k={sent:!1}}if(R){u.debug.log("fetch_personal_info -> user has identity cookie(s)");c.is_logged_in=!0;F+=q;u.debug.log("fetch_personal_info -> bsd graph url: "+F);I=new Date;U=e.ajax({url:F,dataType:"jsonp",jsonp:"jsonp_callback",timeout:1e4});U.done(function(){c.sendResponseTimeToGA(I,"Identity Graph Call")})}else{u.debug.log("fetch_personal_info -> not logged in to identity, so no identityRequest");U=!1}if(n&&n!==""){u.debug.log("fetch_personal_info -> hashcloud information exists, so making a hashcloud request");if(u.getURLParam("keycode")){u.debug.log("fetch_personal_info -> getting the hashcloud keycode from the url");D=u.getURLParam("keycode")}else{u.debug.log("fetch_personal_info -> getting the hashcloud keycode from the cookie");D=e.cookie("donorhash")}e.cookie("donorhash",D,{expires:365,path:"/",domain:u.cookieDomain,secure:!1});v=new Date;L=e.ajax({url:"https://hashcloud.dnc.org/people/"+D+".jsonp?callback=?",dataType:"json",timeout:1e4});L.done(function(){c.sendResponseTimeToGA(v,"HashCloud")})}else{u.debug.log("fetch_personal_info -> no hashcloud information exists, so no hashcloud request");L={sent:!1}}u.debug.log("fetch_personal_info -> always making a spud request");m=new Date;A=e.ajax({url:a,dataType:"jsonp",timeout:1e4});A.done(function(){c.sendResponseTimeToGA(m,"Spud Info")});e.when(k,U,L,A).then(B,j)}};c.old&&c.old.callback&&c.callback.queue.add(c.old.callback);h=function(e){var t=n.createElement("iframe");t.style.display="none";t.src=e;document.body.appendChild(t)};t.USER_DATA=c;p.test(n.cookie)&&(!d.test(n.cookie)||!v.test(n.cookie))&&h(o+"/ctl/Constituent/login?successurl=https%3A%2F%2Fcontribute.barackobama.com%2Fdonation%2Fblank.html");c.fetch_personal_info()})(jQuery,window,document)}catch(err){typeof console!="undefined"&&console.log("js error in user_data function")}window.ofa||(window.ofa={});var ofa=window.ofa;ofa.getURLParam=getURLParam;ofa.isProduction=function(e){var t=/(www|donate|my|contribute|dashboard|call|login)\.barackobama\.com/;return t.test(e.URL)}(document);ofa.cookieDomain=function(){var e=$("script[data-identity]").data("www");return e.split("www")[1]}();ofa.debug={};ofa.debug.enabled=typeof window.ofa_debug=="boolean"||jQuery(".ofa-debug").length>0?!0:!1;ofa.debug.ie_enabled=jQuery(".ofa-ie-debug").length>0?!0:!1;ofa.debug.log=function(){var e=typeof console=="undefined"?!0:!1,t=function(e){console.log(e)},n=ofa.debug.ie_enabled?function(e){alert(e)}:function(){},r=e?n:t;return ofa.debug.enabled?r:function(){}}();jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined)n.expires=-1;if(typeof n.expires=="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return e}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null};var JSON;JSON||(JSON={});(function(){function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e));typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent;u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)if(typeof rep[n]=="string"){r=rep[n];i=str(r,a);i&&u.push(quote(r)+(gap?": ":":")+i)}}else for(r in a)if(Object.prototype.hasOwnProperty.call(a,r)){i=str(r,a);i&&u.push(quote(r)+(gap?": ":":")+i)}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function f(e){return e<10?"0"+e:e}"use strict";if(typeof Date.prototype.toJSON!="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")});typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);r!==undefined?i[n]=r:delete i[n]}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})})();try{(typeof window.localStorage=="undefined"||typeof window.sessionStorage=="undefined")&&function(){var e=function(e){function t(){var t=e=="session"?window.name:i("localStorage");return t?JSON.parse(t):{}}function n(){e=="session"?window.name="":s("localStorage","",365)}function r(t){t=JSON.stringify(t);e=="session"?window.name=t:s("localStorage",t,365)}function i(e){var t=e+"=",n=document.cookie.split(";"),r,i;for(r=0;r<n.length;r++){i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function s(e,t,n){var r,i;if(n){r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);i="; expires="+r.toGMTString()}else i="";document.cookie=e+"="+t+i+"; path=/"}var o=t();return{length:0,clear:function(){o={};this.length=0;n()},getItem:function(e){return o[e]===undefined?null:o[e]},key:function(e){var t=0;for(var n in o){if(t==e)return n;t++}return null},removeItem:function(e){delete o[e];this.length--;r(o)},setItem:function(e,t){o[e]=t+"";this.length++;r(o)}}};typeof window.localStorage=="undefined"&&(window.localStorage=new e("local"));typeof window.sessionStorage=="undefined"&&(window.sessionStorage=new e("session"))}()}catch(err){ofa.debug.log("error in the storage polyfill")}try{window.matchMedia=window.matchMedia||function(e,t){var n,r=e.documentElement,i=r.firstElementChild||r.firstChild,s=e.createElement("body"),o=e.createElement("div");o.id="mq-test-1";o.style.cssText="position:absolute;top:-100em";s.appendChild(o);return function(e){o.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>';r.insertBefore(s,i);n=o.offsetWidth==42;r.removeChild(s);return{matches:n,media:e}}}(document)}catch(err){ofa.debug.log("error in the matchMedia polyfill")}ofa_user_has_engaged=!1;$(document).click(function(){ofa_user_has_engaged=!0}).keydown(function(){ofa_user_has_engaged=!0});$.cookie("guid")&&$.cookie("guid",$.cookie("guid"),{expires:729,path:"/",domain:ofa.cookieDomain,secure:!0});ofa.adjust_auth_bar=function(e){ofa.debug.log("USER_DATA.adjust_auth_bar();");var t=$("script[data-identity]"),n=t.data("identity"),r=t.data("www"),i=t.data("bsd"),s=/\/page\/contribute/,o=/\/page\/cde\/Contribution\/Charge/,u=s.test(document.URL),a=o.test(document.URL),f=n,l=i,c,h,p;if(e.is_logged_in){ofa.debug.log("user is logged in so changing all of auth bar");$(".quick-signup form").remove();$("#gfr-nav").attr("href",i+"/page/outreach/dashboard/2012");$(".login a").text(e.account.first_name+" "+e.account.last_name).attr({href:f,title:"Manage my account"});$(".create-account a").parent().removeClass("single").end().text("Log out").attr("href",f+"/logout/confirm?next="+encodeURIComponent(document.URL)).removeAttr("title").click(function(e){e.preventDefault();if(a){p=l+"/page/contribute/"+$('[name="slug"]').val();ofa.debug.log("redirectURL: "+p)}else{ofa.debug.log("redirectURL: "+document.URL);p=document.URL}ofa.log_out(p)})}else{ofa.debug.log("user is not logged in so only changing success url on login link");c="/login?next=";h="/account/new";if(u||a){p=l+"/page/contribute/"+$('[name="slug"]').val();ofa.debug.log("Donate error page, so changing login success to: "+p)}else{ofa.debug.log("using document.URL as login sucess");p=document.URL}$(".login a").attr("href",f+c+encodeURIComponent(p));$(".create-account a").attr("href",f+h)}};ofa.log_out=function(e){ofa.debug.log("ofa.log_out();");var t=$("script[data-identity]"),n=t.data("identity"),r=$.cookie("_csrf_token"),i,s;ofa.debug.log("ofa.log_out -> logging out using identity server");s=n+"/logout";s+=r?"?csrf_token="+r+"&":"/confirm?";s+="next="+encodeURIComponent(document.URL);window.location=s};ofa.populate_fields=function(e){ofa.debug.log("populate_fields();");var t=function(){ofa.debug.log("populate_fields -> set_field_values();");$("input[name='firstname']").val(e.first_name);$("input[name='lastname']").val(e.last_name);$("input[name='email']").val(e.email);$("input[name='phone']").val(e.phone);$("input[name='addr1']").val(e.address.street);$("input[name='addr2']").val(e.address.street_2);$("input[name='city']").val(e.address.city);$("select[name='state_cd']").val(e.address.state);$("input[name='zip']").val(e.address.zip);$("input[name='occupation']").val(e.occupation);$("input[name='employer']").val(e.employer);if(e.type==="quick donate"&&e.quick_donate.cc_type&&e.quick_donate.cc_last_four&&e.quick_donate.cc_expir_month&&e.quick_donate.cc_expir_year&&e.quick_donate.token){ofa.debug.log("populate_fields -> user_data object type is quick donate and has all the necessary values to populate fields");e.quick_donate.cc_type==="ax"?$("#cc_number").val("XXXXXXXXXXX"+e.quick_donate.cc_last_four):(e.quick_donate.cc_type==="vs"||e.quick_donate.cc_type==="ds"||e.quick_donate.cc_type==="mc")&&$("#cc_number").val("XXXXXXXXXXXX"+e.quick_donate.cc_last_four);$("[value="+e.quick_donate.cc_type+"]").attr("checked","checked");$("#cc_expir_month").val(e.quick_donate.cc_expir_month);$("#cc_expir_year").val(e.quick_donate.cc_expir_year);$("#BSDForm-quick_donate_populated").attr("value",e.quick_donate.token)}else ofa.debug.log("populate_fields -> user_data object does not have necessary values to populate payment info")};if(e.type){ofa.debug.log("populate_fields -> USER_DATA has a type");if(typeof ofa_disable_prefill=="undefined"&&$("[data-ofa-disable-prefill]").length===0){ofa.debug.log("populate_fields -> typeof ofa_disable_prefill === 'undefined'");if(e.is_donate_page===!0){ofa.debug.log("populate_fields -> USER_DATA.is_donate_page === true");t()}else{ofa.debug.log("populate_fields -> USER_DATA.is_donate_page === false");if(ofa_user_has_engaged===!1){ofa.debug.log("populate_fields -> user has not engaged");t()}else ofa.debug.log("populate_fields -> user has engaged")}}else ofa.debug.log("populate_fields -> ofa_disable_prefill is not undefined")}else ofa.debug.log("populate_fields -> there is no data in user object.");ofa.adjust_auth_bar(e)};(function(e,t){var n=t.USER_DATA||{callback:[]},r=t.ofa;n.callback.push(r.populate_fields);t.USER_DATA||(t.USER_DATA=n)})(jQuery,window);(function(e){var t=/\/page\/contribute\//;t.test(document.URL)||e('[type="submit"], button').click(function(t){var n=/\.mil$|\.gov$|\.wi\.us$|milwcnty\.com$|countyofdane\.com$|cityofmadison\.com$|cityoflacrosse\.org$|cityofracine\.org$|kenosha\.org$/,r=e(this),i=r.parents("form").find("[name='email']")[0],s;if(i){s=e(i).val();if(n.test(s)){alert('Please enter an email address that does not end in "'+n.exec(s)+'"');e(i).focus();t.preventDefault()}}})})(jQuery);(function(e,t,n){function r(e){var t,n,r,i=document,s=i.documentElement,o=s.getElementsByTagName("head")[0],u=i.implementation||{hasFeature:function(){return!1}},n=i.createElement("style");n.type="text/css";(o||s).insertBefore(n,(o||s).firstChild);r=n.sheet||n.styleSheet
;if(!r||!e)return!1;t=u.hasFeature("CSS2","")?function(e){try{r.insertRule(e+"{ }",0);r.deleteRule(r.cssRules.length-1)}catch(t){return!1}return!0}:function(e){r.cssText=e+" { }";return r.cssText.length!==0&&!/unknown/i.test(r.cssText)&&r.cssText.indexOf(e)===0};return t(e)}function g(e){if(typeof d[e]!="undefined"){var t=f.find(".local"),n=t.find(".top-level-link"),r=t.find(".subnav");if(!t.length||!n.length||!r.length)return;r.is(".state-subnav")&&r.empty().removeClass("state-subnav").append('<li><a href="'+n.attr("href")+'" title="Choose a Different State">Choose a Different State</a></li>');n.attr({title:d[e],href:"http://www.barackobama.com/state/"+e}).text(d[e]);t.addClass("localized")}}function b(e){u.prepend('<link href="'+e+'" rel="stylesheet" />')}function w(e){return[h.replace(/\/$/,""),e.replace(/^\//,"")].join("/")}function k(){e("object").each(function(t){var n=e(this);if(n.attr("wmode")!=="transparent"){n.attr("wmode","transparent");n.wrap("<span />")}})}Modernizr.addTest("targetselector",function(){return r(":target")});Modernizr.addTest("nthchildselector",function(){return r(":nth-child(odd)")});var s=e("html"),o=e("body"),u=e("head"),a=e("#action-bar"),f=e("#primary-nav"),l=a.find(".logo"),c=e("#main"),h=e("script[data-js-base]").length?e("script[data-js-base]").data("js-base"):"http://assets.bostatic.com/",p,d={WA:"Washington",DE:"Delaware",DC:"Washington, DC",WI:"Wisconsin",WV:"West Virginia",HI:"Hawaii",FL:"Florida",WY:"Wyoming",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",TX:"Texas",LA:"Louisiana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",TN:"Tennessee",NY:"New York",PA:"Pennsylvania",CA:"California",NV:"Nevada",VA:"Virginia",CO:"Colorado",AK:"Alaska",AL:"Alabama",AR:"Arkansas",VT:"Vermont",IL:"Illinois",GA:"Georgia",IN:"Indiana",IA:"Iowa",OK:"Oklahoma",AZ:"Arizona",ID:"Idaho",CT:"Connecticut",ME:"Maine",MD:"Maryland",MA:"Massachusetts",OH:"Ohio",UT:"Utah",MO:"Missouri",MN:"Minnesota",MI:"Michigan",RI:"Rhode Island",KS:"Kansas",MT:"Montana",MS:"Mississippi",SC:"South Carolina",KY:"Kentucky",OR:"Oregon",SD:"South Dakota"},v=e("body.donate").length?!0:!1,m;ofa.is=function(e,t){return typeof e==t};ofa.defined=function(e){return typeof e!="undefined"};ofa.localizeNav=g;if(e.cookie("region")){var y=e.cookie("region");m=!0;g(y)}ofa.insertStyleSheet=b;ofa.cdnPrefix=w;yepnope({test:typeof ofa.modal=="undefined",yep:w("/hydepark/js/modals.js")});ofa.fbQueue=e.Callbacks("once memory unique");ofa.load=function(t){typeof t=="string"&&(t=[t]);var n=t.length,r=e('meta[property="fb:app_id"]').length?e('meta[property="fb:app_id"]').attr("content"):"111399285589490",i;while(n--){i=t[n];switch(i){case"mustache":typeof Mustache=="undefined"&&yepnope(w("/frontend/utils/vendors/mustache.js"));break;case"twitter":if(typeof twttr=="undefined"){yepnope("//platform.twitter.com/widgets.js");e('a[href*="twitter.com/intent"]').click(function(e){e.preventDefault()})}break;case"facebook":if(typeof FB=="undefined"){window.fbAsyncInit=function(){FB.init({appId:r,channelURL:"//"+window.location.hostname+"/channel",status:!0,cookie:!0,oauth:!0,xfbml:!0});FB.getLoginStatus(function(e){p=e.authResponse;ofa.fbQueue.fire(e)})};yepnope({test:e("body.spanish").length,yep:"https://connect.facebook.net/es_LA/all.js",nope:"https://connect.facebook.net/en_US/all.js"})}break;case"tweet-box":if(typeof tweetbox=="undefined"){yepnope(w("/frontend/widgets/tweet-box/tweet-box-1.5.min.js"));b(w("/hydepark/css/tweets.css"))}break;case"blog":typeof ofa.blog=="undefined"&&yepnope(w("/hydepark/js/blog-1.2.min.js"));break;case"local-events":typeof ofa.localEvents=="undefined"&&yepnope(w("/hydepark/js/module.local-events.min.js"));break;case"sliders":if(typeof ofa.sliders=="undefined"){yepnope(w("/hydepark/js/sliders.min.js"));b(w("/hydepark/css/sliders.css"))}break;case"timelines":typeof ofa.timelines=="undefined"&&yepnope(w("/hydepark/js/timelines.js"));break;default:typeof console!="undefined"&&typeof console.warn!="undefined"&&console.warn(i+" is not supported in ofa.load")}}};if(!v){ofa.load("mustache");ofa.load("twitter");ofa.load("facebook")}yepnope(w("/hydepark/js/ga-extra.min.js"));window.loadOpenGraphAPI&&yepnope(e("[data-og-script]").length?ofa.cdnPrefix(e("[data-og-script]").data("og-script")):ofa.cdnPrefix("/uptown/js/modules/og-api.js"));o.delegate('a[href*="facebook.com/sharer"]',"click",function(n){n.preventDefault();var r="",i=!0,s=e(this).attr("href").split("?");if(s.length>1){var o=s[1].split("&"),u,a=o.length;s={};while(a--){u=o[a].split("=");if(u.length>1&&u[0]==="u"){i=u[1].split("?")[0]!=window.location.href;r=decodeURIComponent(u.slice(1).join("="))}}}if(p){var f=e(this);if(i)FB.ui({method:"feed",link:r,name:f.data("og-title")?decodeURIComponent(f.data("og-title")):"",picture:f.data("og-image")?f.data("og-image"):"",description:f.data("og-description")?decodeURIComponent(f.data("og-description")):"",display:Modernizr.touch?"touch":"iframe"});else{var f=e(this),l=f.data("og-title")?f.data("og-title"):e('meta[property="og:title"][content]').length?e('meta[property="og:title"][content]').attr("content"):"",c=f.data("og-description")?f.data("og-description"):e('meta[property="og:description"][content]').length?e('meta[property="og:description"][content]').attr("content"):"",h=f.data("og-image")?f.data("og-image"):e('meta[property="og:image"][content]').length?e('meta[property="og:image"][content]').attr("content"):"",d=f.data("og-url")?f.data("og-url"):e('meta[property="og:url"][content]').length?e('meta[property="og:url"][content]').attr("content"):t.location.href;FB.ui({method:"feed",name:l,link:d,picture:h,description:c,display:Modernizr.touch?"touch":"iframe"})}}else window.open(e(this).attr("href"),"facebook","height=400,width=640,location=0,menubar=0,status=0,toolbar=0")});yepnope({test:e("iframe[src*=youtube], iframe[src*=vimeo]").length&&typeof e.browser.mozilla=="undefined",yep:[h,"frontend","utils","vendors","jquery.fitvids.js"].join("/"),callback:function(){e("iframe[src*=youtube], iframe[src*=vimeo]").wrap('<div class="fitvid" />');e(".fitvid").fitVids()}});yepnope({test:e("iframe[src*=youtube]").length&&e(".ie7.oldie, .ie8.oldie, .ie9").length===0,yep:[h,"frontend","projects","yt-analytics","ofaYTAnalytics.min.js"].join("/")});e("#tweets .entry-content").length&&ofa.load("tweet-box");o.delegate(":input","focus",function(){e(this).addClass("focused")});e(".blog-posts").length&&ofa.load("blog");e(".module.local-events").length&&ofa.load("local-events");e(".slider").length&&ofa.load("sliders");yepnope({test:Modernizr.input.placeholder,nope:w("/frontend/polyfills/vendors/Placeholder-jQuery-Plugin/jquery.placeholder.min.js"),callback:function(){s.addClass("placeholder-polyfilled");e("input, textarea").placeholder()}});yepnope([h,"js","ofa-chiclet.js"].join("/"));o.delegate("#primary-nav .local .state-subnav a, #main .state-chooser a","click",function(t){t.preventDefault();var n=e(this);e.cookie("region",n.data("abbr"),{expires:new Date("2012/11/07 23:59:59")});setTimeout(function(){window.location=n.attr("href")},100)});e(".timeline").length&&ofa.load("timelines");var E=e("[data-button-title]");E.length&&e('form#signup input[type="submit"],form#contribution input[type="submit"],form#invitationpage input[type="submit"]').val(E.data("button-title"));var S=e.cookie("source"),x=e.cookie("subsource"),T;if(window.location.search.length&&window.location.search.indexOf("source")>-1){S=getURLParam("source");e.cookie("source",S,{expires:1,domain:ofa.cookieDomain,path:"/"})}if(window.location.search.length&&window.location.search.indexOf("subsource")>-1){x=getURLParam("subsource");e.cookie("subsource",x,{expires:1,domain:ofa.cookieDomain,path:"/"})}if(S||x){T=S?S:"";T+=S&&x?",":"";T+=x?x:"";e("form").each(function(){var t=e(this),n=t.find('input[name="source_codes"]').length?t.find('input[name="source_codes"]'):e('<input type="hidden" name="source_codes" />').appendTo(t);S&&t.attr("action")&&t.attr("action",t.attr("action")+(t.attr("action").indexOf("?")>-1?"&":"?")+"source="+S);x&&t.attr("action")&&t.attr("action",t.attr("action")+(t.attr("action").indexOf("?")>-1?"&":"?")+"subsource="+x);if(n.val()){var r=n.val().split(","),s=!1;for(i=0;i<=r.length-1;i++)r[i]=="FI"&&(s=!0);s||n.val(n.val()+","+T)}else n.val(T)})}var N={trim:typeof String.prototype.trim?function(e){return e==null?"":String.prototype.trim.call(e)}:function(e){return e==null?"":e.toString().replace(/^\s+/,"").replace(/\s+$/,"")},inArray:function(e,t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},l_pad:function(e,t,n){e=e.toString();n=n.toString();var r="";while(r.length<t)r=n+r;e=r.substr(0,t-e.length)+e;return e},r_pad:function(e,t,n){e=e.toString();n=n.toString();while(e.length<t)e+=n;e=e.substr(0,t);return e},parseDate:function(e){var t=new Date(e.replace(/-/g,"/"));return t.toString().toLowerCase()=="invalid date"?e:t}};for(var C in N)ofa[C]=N[C];ofa.formatDate=function(e,t){function o(e){var t=["th","st","nd","rd","th","th","th","th","th","th"],n=parseInt(String(e).replace(/[^\d]+/g,""),10);return isNaN(n)?e:N.inArray(n%100,[11,12,13])>-1?[e,t[0]].join(""):[e,t[n%10]].join("")}function u(e){e>12?e-=12:e===0&&(e=12);return e}if(!e||e.toString&&e.toString().toLowerCase()=="invalid date")return e;t=t||"N j, Y";var n=new Date(e.getFullYear(),0,1),r={l:["January","February","March","April","May","June","July","August","September","October","November","December"],s:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ap:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."]},i={l:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},s={ap:{am:"a.m.",pm:"p.m."},normal:{am:"AM",pm:"PM",0:"midnight",12:"noon"}};ofa.formatDate.ordinal=o;var a={a:e.getHours()<12?s.ap.am:s.ap.pm,A:e.getHours()<12?s.normal.am:s.normal.pm,b:r.s[e.getMonth()].toLowerCase(),d:N.l_pad(e.getDate(),2,0),D:i.s[e.getDay()],E:r.l[e.getMonth()],f:function(e){var t=[u(e.getHours())];if(e.getMinutes()!==0){t.push(":");t.push(N.l_pad(e.getMinutes(),2,0))}return t.join("")}(e),F:r.l[e.getMonth()],g:u(e.getHours()),G:e.getHours(),h:N.l_pad(u(e.getHours()),2,0),H:N.l_pad(e.getHours(),2,0),i:N.l_pad(e.getMinutes(),2,0),j:e.getDate(),l:i.l[e.getDay()],L:Boolean((new Date(e.getFullYear(),1,29)).getDate()==29),m:N.l_pad(e.getMonth()+1,2,0),M:r.s[e.getMonth()],n:e.getMonth()+1,N:r.ap[e.getMonth()],O:function(e){var t=Math.ceil(e.getTimezoneOffset()/60),n=e.getTimezoneOffset()%60;return(t<=0?"+":"-")+N.l_pad(t,2,0)+N.l_pad(n,2,0)}(e),P:function(e){if(e.getHours()!==0&&e.getHours()!==12||e.getMinutes()!==0){var t=[u(e.getHours())];if(e.getMinutes()!==0){t.push(":");t.push(N.l_pad(e.getMinutes(),2,0))}t.push(" ");t.push(e.getHours()<12?s.ap.am:s.ap.pm);return t.join("")}return s.normal[e.getHours()]}(e),s:N.l_pad(e.getSeconds(),2,0),S:o(e.getDate()).replace(e.getDate(),""),t:32-(new Date(e.getYear(),e.getMonth(),32)).getDate(),T:function(e){var t=e.toTimeString();t=t.substring(t.indexOf("(")+1,t.length-1);return t}(e),u:e.getMilliseconds()*1e3,U:Math.floor(e.getTime()/1e3),w:e.getDay(),W:function(e){var t=n.getDay();t=t>=0?t:t+7;var r=Math.floor((e.getTime()-n.getTime()-(e.getTimezoneOffset()-n.getTimezoneOffset())*6e4)/864e5)+1,i;if(t<4){i=Math.floor((r+t-1)/7)+1;if(i>52){t=(new Date(e.getFullYear()+1,0,1)).getDay();t=t>=0?t:t+7;i=t<4?1:53}}else i=Math.floor((r+t-1)/7);return i>0?i:1}(e),y:e.getFullYear().toString().substr(2),Y:e.getFullYear(),z:Math.ceil((e-n)/864e5),Z:function(e){var t=e.getTimezoneOffset()*60*-1;return(t<0?"-":"")+N.r_pad(Math.abs(t),5,0)}(e)};a.c=[a.Y,"-",a.m,"-",a.d,"T",a.H,":",a.i,":",a.s,".",N.l_pad(a.u,6,0)].join("");a.r=[a.D,", ",a.j," ",a.M," ",a.Y," ",a.H,":",a.i,":",a.s," ",a.O].join("");t=t.split("");t.reverse();var f=[],l;for(var c=t.length-1;c>=0;c--){var h=t[c];if(l==="%"||h==="%"){l==="%"&&f.push(h);l=h;continue}f.push(h in a?a[h]:h)}return f.length===1&&typeof f[0]=="boolean"?f[0]:f.join("")};e(t).load(function(){s.addClass("loaded")});k();o.ajaxComplete(k);e("#action-bar .quick-signup a.button").click(function(e){e.preventDefault();o.toggleClass("show-quick-signup")});var L=function(e){var t=!1,n=e('meta[name="viewport"]'),r,i,s;if(n.length>0){r=n.attr("content").split(",");for(s=0;s<r.length;s++){i=r[s].split("=");if(i[0]==="width"&&i[1]==="device-width"){t=!0;break}}}return t}(jQuery);if(L&&f.length&&l.length&&!l.closest(".logo-only").length){l.add("#action-bar .logo-link i").click(function(e){if(!(ofa.defined(t.matchMedia)&&t.matchMedia("(min-width:960px)").matches||!ofa.defined(t.matchMedia))){e.preventDefault();e.stopPropagation();s.toggleClass("show-nav");s.add(o).scrollTop(0)}});o.click(function(){s.removeClass("show-nav")});f.click(function(e){ofa.defined(t.matchMedia)&&t.matchMedia("(min-width:960px)").matches||!ofa.defined(t.matchMedia)||e.stopPropagation()})}if(Modernizr.touch){var A=f.find(".top-level-link");A.click(function(n){var r=e(this);if(ofa.defined(t.matchMedia)&&t.matchMedia("(min-width:960px)").matches||!ofa.defined(t.matchMedia))if(!r.data("clicked")){n.preventDefault();r.data("clicked",!0)}else r.data("clicked",!1)})}})(jQuery,window,document);(function(e){function o(){s.content="width=device-width,minimum-scale="+i[0]+",maximum-scale="+i[1];e.removeEventListener(n,o,!0)}if(typeof e.addEventListener=="undefined")return;var t="addEventListener",n="gesturestart",r="querySelectorAll",i=[1,1],s=r in e?e[r]("meta[name=viewport]"):[];if((s=s[s.length-1])&&t in e&&s.content.toLowerCase().indexOf("width=device-width")>-1){o();i=[.25,1.6];e[t](n,o,!0)}})(document);try{var ua=window.navigator.userAgent.toLowerCase();if(ua.indexOf("windows")>-1&&ua.indexOf("chrome")>-1){TypekitConfig={kitId:"nfn3icp"};(function(){var e=document.createElement("script");e.src="//use.typekit.com/"+TypekitConfig.kitId+".js";e.type="text/javascript";e.async="true";e.onload=e.onreadystatechange=function(){var e=this.readyState;if(e&&e!="complete"&&e!="loaded")return;try{Typekit.load(TypekitConfig)}catch(t){}};var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();$('link[href*="typography.com"]').attr("rel","alternate")}}catch(e){}(function(e,t){var n=e("#om-donate"),r,i;if(n.length){r=t.createElement("a");r.href=t.location.href;n.prop("href",n.prop("href")+r.search)}})(jQuery,document);(function(e,t,n){var r=e("subnav-column li:not(.subnav-header)"),i={WA:"Washington",DE:"Delaware",DC:"Washington, DC",WI:"Wisconsin",WV:"West Virginia",HI:"Hawaii",FL:"Florida",WY:"Wyoming",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",TX:"Texas",LA:"Louisiana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",TN:"Tennessee",NY:"New York",PA:"Pennsylvania",CA:"California",NV:"Nevada",VA:"Virginia",CO:"Colorado",AK:"Alaska",AL:"Alabama",AR:"Arkansas",VT:"Vermont",IL:"Illinois",GA:"Georgia",IN:"Indiana",IA:"Iowa",OK:"Oklahoma",AZ:"Arizona",ID:"Idaho",CT:"Connecticut",ME:"Maine",MD:"Maryland",MA:"Massachusetts",OH:"Ohio",UT:"Utah",MO:"Missouri",MN:"Minnesota",MI:"Michigan",RI:"Rhode Island",KS:"Kansas",MT:"Montana",MS:"Mississippi",SC:"South Carolina",KY:"Kentucky",OR:"Oregon",SD:"South Dakota"},s=e(".subnav-column").find(".subnav-header"),o="li:not(.subnav-header)",u=e(".subnav-header");if(e("body.donate").length<1){s.each(function(){e(this).find("> a").append('<i class="triangle"></i>')});e(".top-level-link").click(function(t){e(this).find("i").length>0&&t.preventDefault()});e(".subnav-column").on("click",u,function(){r.hide();if(e(this).find(o).css("display")==="none"){e(this).find(o).show();e(this).find(u).find("i.triangle").hide();return!1}return!0});function a(t){var n=e("#localized-state"),r=e("#localized-blog"),s=e("#localized-voting"),o=e(".subnav-column.volunteer"),u=e("#not-your-state");if(typeof i[t]!="undefined"){if(!n.length)return;n.attr({title:"Get Involved: "+i[t],href:"http://www.barackobama.com/state/"+t+"?source=primary-nav-get-involved"}).text("Get Involved: "+i[t]);r.attr({title:i[t]+"'s blog",href:"http://www.barackobama.com/state/"+t+"?source=primary-nav"}).text(i[t]+"'s blog");s.attr({title:"Get voting info for "+t,href:"http://vote.barackobama.com/"+t+"?source=primary-nav"}).text("Get voting info for "+t);o.find(".subnav-header > a").append(" in "+t)}u.attr({title:"Not in "+t+"?",href:"http://www.barackobama.com/state/?source=primary-nav"}).text("Not in "+t+"?")}ofa.localizeNav=a;if(e.cookie("region")){var f=e.cookie("region"),l=!0;a(f)}var c=e("#menu-icon"),h=function(t){t.preventDefault();var n=e("#primary-nav").offset().top-e("#action-bar").outerHeight(!0);e("html,body").animate({scrollTop:n},500)};c.click(h);var p=e("#action-bar, .donate-auth, #forward, #primary-nav");p.each(function(){e(this).insertBefore("#ft")});var d=e("#stay"),v=!1,m,g,y,b,w=e("#main"),E=e("#primary-nav"),S=e("#action-bar").outerHeight(!0),x,T=d.add(d.siblings());T.each(function(){if(e(this).is(d))return;x?x.add(e(this)):x=e(this)});function N(){var t=d.parent().offset().top;x&&x.each(function(){t+=e(this).outerHeight(!0)});return t}var C=function(){var t=e("body").scrollTop();g=e("body").height()-(y+b-80);w.width()>=748&&w.width()<=940&&(g=g-E.outerHeight(!0)-80);if(v)if(t>m){d.removeClass("bottomed");d.addClass("fixed");if(t>g){d.removeClass("fixed");d.addClass("bottomed")}}else d.removeClass("fixed bottomed");else d.removeClass("fixed bottomed")},k=function(){m=N()-S-20;y=e("#ft").outerHeight(!0);b=d.outerHeight(!0);g=e("body").height()-(y+b-80);w.width()>=748&&w.width()<=940&&(g=g-E.outerHeight(!0)-80);d.outerHeight(!0)<e(window).height()?v=!0:v=!1};if(d.length){w.css("position","relative");k();e(window).scroll(function(e){C()}).resize(function(){k()});x&&x.find("img").on("load",function(){k()});e("body").find("img").on("load",function(){k()});e("li.previous").on("click",function(){L(e("body").height())})}function L(t){if(t===e("body").height()){setTimeout(function(){L(t)},500);return}k();C()}}})(jQuery,window,document);